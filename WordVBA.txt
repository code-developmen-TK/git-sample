Option Explicit

Sub ボタン1_Click()
'excel VBAを利用し、テンプレートとなるワードファイルの一部分をエクセルデータで置換を行い、新しいワードファイルとして保存する
'https://oshiete.goo.ne.jp/qa/5989414.html
'
Dim wdApp As Word.Application
Dim wdDoc As Word.Document
Dim wdRng As Word.Range
Dim Fname As String
Dim sOutputAs As String
Dim mPath As String
Dim mRowAs As Long
Dim sh As Worksheet

Set wdApp = New Word.Application

Const CALC_SHEET As String = "Sheet1" '←シート名

Set sh = Worksheets(CALC_SHEET) 'データ取得用シート

sh.Select

mPath = ActiveWorkbook.Path & "\"

Fname = mPath & "xxxxxx.doc"

sOutput = mPath & "\"

On Error GoTo ErrHandler
'元の文書

    If Dir(Fname) = "" Then

        MsgBox "元の文書がありません。", vbExclamation

        GoTo ErrHandler
        
    End If
    
    mRow = 3
    
    Do
    
        With wdApp
            Set wdDoc = .Documents.Open(Fname)
            Set wdRng = wdDoc.Content
        End With

        With wdRng.Find
            .Text = "[置換対象文字]"
            .Forward = True
            .Replacement.Text = Range("C" & mRow).Value
            .MatchCase = False
            .MatchWildcards = False
            .MatchFuzzy = True
            '.Execute Replace:=wdReplaceAll 'Ver Word2003
            .Execute , , , , , , , , , , wdReplaceAll
        End With
        
        sOutput = mPath & "test1\" & Range("C" & mRow).Value & ".doc"
        wdDoc.SaveAs sOutput '置換後のword文書を別名で保存
        wdDoc.Close False
        mRow = mRow + 1
        
    Loop Until sh.Range("C" & mRow).Value = ""

    wdApp.Quit

ErrHandler:
    If Err.Number > 0 Then
        MsgBox Err.Number & " : " & Err.Description
    Else
        Beep '正常終了
    End If
    
    Set wdRng = Nothing
    Set wdDoc = Nothing
    Set wdApp = Nothing
    Set sh = Nothing
    
End Sub
