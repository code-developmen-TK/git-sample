Option Compare Database
Option Explicit

Public Function file_selection_dialog(initial_file_pass As String) As Variant
'************************************************************************
'参照設定を使用せずにアクセスでファイル選択ダイアログを使うには
'https://waq3-travelog.com/file-picker-dialog/
'
'
'**************************************************************************
Dim taget_file_name As Variant
Const msoFileDialogFilePicker As Integer = 3 'ファイルを選択する場合は、msoFileDialogFilePicker →　3（定数）

On Error GoTo ErrHNDL  'エラー処理を宣言します。エラーが生じたら ErrHNDL 部分へ飛びます。

'ファイル参照用の設定値をセットします。

If initial_file_pass = "" Then

    initial_file_pass = CurrentProject.Path     '最初に開くフォルダーを、当ファイルが存在しているフォルダーとします。


End If

With Application.FileDialog(msoFileDialogFilePicker)

    'ダイアログタイトル名
    .Title = "ファイルを選択してください"

     'ファイルの種類を定義します。
    .Filters.Clear
    .Filters.Add "テキストファイル", "*.txt,*.csv"

     '複数ファイル選択を可能にする場合はTrue、不可の場合はFalse。
    .AllowMultiSelect = False

    .InitialFileName = initial_file_pass & "\"

    If .Show = -1 Then 'ファイルが選択されれば　-1 を返します。
        For Each taget_file_name In .SelectedItems
             file_selection_dialog = taget_file_name
        Next
    End If
     
End With

Exit Function

ErrHNDL:

     MsgBox Err.Number & vbCrLf & Err.Description
     Exit Function
     
End Function

Public Function create_temporary_table(table_name As String)


End Function

Public Function delete_temporary_table(table_name As String)

End Function
